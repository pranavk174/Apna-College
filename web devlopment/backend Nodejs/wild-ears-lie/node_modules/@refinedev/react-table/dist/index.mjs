"use client"
var I=Object.defineProperty;var i=(t,o)=>I(t,"name",{value:o,configurable:!0});import{useEffect as F}from"react";import{useTable as A}from"@refinedev/core";import{useReactTable as j,getCoreRowModel as q,getSortedRowModel as G,getFilteredRowModel as J}from"@tanstack/react-table";import{useEffect as M,useRef as U}from"react";var x=i(()=>{let t=U(!0);return M(()=>{t.current=!1},[]),t.current},"useIsFirstRender");var P=i(({columns:t,columnFilters:o})=>(o==null?void 0:o.map(e=>{var a,d,p,u;let r=e.operator??((d=(a=t.find(c=>c.id===e.id))==null?void 0:a.meta)==null?void 0:d.filterOperator);if((r==="and"||r==="or")&&Array.isArray(e.value))return{key:((u=(p=t.find(T=>T.id===e.id))==null?void 0:p.meta)==null?void 0:u.filterKey)??e.id,operator:r,value:e.value};let l=Array.isArray(e.value)?"in":"eq";return{field:e.id,operator:r??l,value:e.value}}))??[],"columnFiltersToCrudFilters");var k=i(({nextFilters:t,coreFilters:o})=>o.filter(r=>!t.some(s=>{let l=r.operator==="and"||r.operator==="or",a=s.operator==="and"||s.operator==="or",d=r.operator===s.operator,p=l&&a&&r.key===s.key,u=!l&&!a&&r.field===s.field;return d&&(p||u)})).map(r=>r.operator==="and"||r.operator==="or"?{key:r.key,operator:r.operator,value:[]}:{field:r.field,operator:r.operator,value:void 0}),"getRemovedFilters");var O=i(({columns:t,crudFilters:o})=>o.map(e=>{var r;return e.operator==="and"||e.operator==="or"?e.key?{id:((r=t.find(l=>{var a;return((a=l.meta)==null?void 0:a.filterKey)===e.key}))==null?void 0:r.id)??e.key,operator:e.operator,value:e.value}:void 0:{id:e.field,operator:e.operator,value:e.value}}).filter(Boolean),"crudFiltersToColumnFilters");function N({refineCoreProps:{hasPagination:t=!0,...o}={},initialState:e={},...r}){var D,S,E;let s=x(),l=A({...o,hasPagination:t}),a=(((D=o.filters)==null?void 0:D.mode)||"server")==="server",d=(((S=o.sorters)==null?void 0:S.mode)||"server")==="server",p=t===!1?"off":"server",u=(((E=o.pagination)==null?void 0:E.mode)??p)!=="off",{tableQuery:{data:c},current:T,setCurrent:y,pageSize:B,setPageSize:L,sorters:Q,setSorters:H,filters:g,setFilters:K,pageCount:h}=l,b=j({data:(c==null?void 0:c.data)??[],getCoreRowModel:q(),getSortedRowModel:d?void 0:G(),getFilteredRowModel:a?void 0:J(),initialState:{pagination:{pageIndex:T-1,pageSize:B},sorting:Q.map(n=>({id:n.field,desc:n.order==="desc"})),columnFilters:O({columns:r.columns,crudFilters:g}),...e},pageCount:h,manualPagination:!0,manualSorting:d,manualFiltering:a,...r}),{state:w,columns:R}=b.options,{pagination:z,sorting:m,columnFilters:v}=w,{pageIndex:f,pageSize:C}=z??{};return F(()=>{f!==void 0&&y(f+1)},[f]),F(()=>{C!==void 0&&L(C)},[C]),F(()=>{m!==void 0&&(H(m==null?void 0:m.map(n=>({field:n.id,order:n.desc?"desc":"asc"}))),m.length>0&&u&&!s&&y(1))},[m]),F(()=>{let n=P({columns:R,columnFilters:v});n.push(...k({nextFilters:n,coreFilters:g})),K(n),n.length>0&&u&&!s&&y(1)},[v,R]),{...b,refineCore:l}}i(N,"useTable");export{N as useTable};
//# sourceMappingURL=index.mjs.map